\addchap[Appendix C:$\quad$3D Graphing with Gnuplot]{Appendix C}
\textsf{\textbf{\Large 3D Graphing with Gnuplot}}\vspace{4mm}

Gnuplot is a free, open-source software package for producing a variety of graphs. Versions are available for many
operating systems. Below is a very brief tutorial on how to use Gnuplot to graph functions of several
variables.\vspace{4mm}

\par\noindent\textbf{INSTALLATION}
\begin{enumerate}
 \item Go to \url{http://www.gnuplot.info/download.html} and follow the links to download the latest version for your
  operating system. For Windows, you should get the Zip file with a name such as \path{gp420win32.zip}, which is
  version 4.2.0. 
  All the examples we will discuss require at least version 4.2.0.
 \item Install the downloaded file. 
 For example, in Windows you would unzip the Zip file you downloaded
  in Step 1 into some folder (use the ``Use folder names'' option if extracting with WinZip).
\end{enumerate}

\par\noindent\textbf{RUNNING GNUPLOT}
\begin{enumerate}
 \item In Windows, run \textbf{\path{wgnuplot.exe}} from the folder (or \path{bin} folder)
  where you installed Gnuplot. In Linux, just type
  \textbf{\path{gnuplot}} in a terminal window.
 \item You should now get a Gnuplot terminal with a \textbf{\path{gnuplot>}} command prompt. In Windows this
  will appear
  in a new window, while in Linux it will appear in the terminal window where the \textbf{\path{gnuplot}} command was
  run. For Windows, if the font is unreadable you can change it by right-clicking on the text part of the Gnuplot window
  and selecting the ``Choose Font..'' option. For example, the font ``Courier'', style ``Regular'', size ``12'' is
  usually a
  good choice (that choice can be saved for future sessions by right-clicking in the Gnuplot window again and selecting
  the option to update wgnuplot.ini).
 \item At the \textbf{\path{gnuplot>}} command prompt you can now run graphing commands, which we will now
  describe.
\end{enumerate}

\par\noindent\textbf{GRAPHING FUNCTIONS}\vspace{2mm}\\
The usual way to create 3D graphs in Gnuplot is with the \textbf{splot} command:
\begin{displaymath}
 \text{splot <range> <comma-separated list of functions>}
\end{displaymath}
For a function $z=f(x,y)$, <range> is the range of $x$ and $y$ values (and optionally the range of $z$ values) over
which to plot.
To specify an $x$ range and a $y$ range, use an expression of the form
\symbol{91}$a:b$\symbol{93}\symbol{91}$c:d$\symbol{93}, for some numbers $a<b$ and $c<d$. This will cause the graph to
be plotted for $a\le x\le b$ and $c\le y \le d$.\vspace{2mm}

\par\noindent Function definitions use the $x$ and $y$ variables in combination with mathematical operators,
listed below:\vspace{1mm}

\begin{center}
\begin{tabular}{@{} | c | c | c | c | @{}}
 \hline \textbf{Symbol} & \textbf{Operation} & \textbf{Example} & \textbf{Result}\\
 \hline $+$ & Addition & $2 + 3$ & $5$\\
 \hline $-$ & Subtraction & $3 - 2$ & $1$\\
 \hline * & Multiplication & $2$*$3$ & $6$\\
 \hline $/$ & Division & $4/2$ & $2$\\
 \hline ** & Power & $2$**$3$ & $2^3 = 8$\\
 \hline exp($x$) & $e^x$ & exp($2$) & $e^2$\\
 \hline log($x$) & $\ln x$ & log($2$) & $\ln 2$\\
 \hline sin($x$) & $\sin x$ & sin(pi/$2$) & $1$\\
 \hline cos($x$) & $\cos x$ & cos(pi) & $-1$\\
 \hline tan($x$) & $\tan x$ & tan(pi/$4$) & $1$\\\hline
\end{tabular}\end{center}

\vspace{2mm}
\hrule width \textwidth height 0.5pt\vspace{2mm}
\par\noindent \emph{\textbf{Example C.1.}}
 To graph the function $z = 2x^2 + y^2$ from $x=-1$ to $x=1$ and from $y=-2$ to $y=2$, type this at the
 \textbf{\path{gnuplot>}} prompt:
 \begin{displaymath}
  \texttt{splot \symbol{91}-1:1\symbol{93}\symbol{91}-2:2\symbol{93} 2*x**2 + y**2}
 \end{displaymath}
 The result is shown below:\vspace{-12mm}
\begin{figure}[h]
 \begin{center}
  \input{appc1}
 \end{center}\vspace{-14mm}
\end{figure}
\hrule width \textwidth height 0.5pt
\newpage
\par\noindent Note that we had to type $2$*x**$2$ to multiply $2$ times $x^2$. For clarity, parentheses can be used to
make sure the operations are being performed in the correct order:
\begin{displaymath}
 \texttt{splot \symbol{91}-1:1\symbol{93}\symbol{91}-2:2\symbol{93} 2*(x**2) + y**2}
\end{displaymath}

\par\noindent In the above example,
 to also plot the function $z=e^{x+y}$ on the same graph, put a comma after the first function then
 append the new function:
 \begin{displaymath}
  \texttt{splot \symbol{91}-1:1\symbol{93}\symbol{91}-2:2\symbol{93} 2*(x**2) + y**2, exp(x+y)}
 \end{displaymath}

\par\noindent By default, the $x$-axis and $y$-axis are not shown in the graph. To display the axes, use this command
\emph{before} the \textbf{splot} command:
\begin{displaymath}
 \texttt{set zeroaxis}
\end{displaymath}
Also, by default the $x$- and $y$-axes are switched from their usual position.
To show the axes with the orientation which we have used throughout the text, use this command:
\begin{displaymath}
 \texttt{set view 60,120,1,1}
\end{displaymath}
Also, to label the axes, use these commands:
\begin{gather*}
 \texttt{set xlabel "x"}\\\texttt{set ylabel "y"}\\\texttt{set zlabel "z"}
\end{gather*}
To show the level curves of the surface $z=f(x,y)$ on both the surface and projected onto the $xy$-plane, use this
command:
\begin{displaymath}
 \texttt{set contour both}
\end{displaymath}
The default mesh size for the grid on the surface is $10$ units. To get more of a colored/shaded surface, increase the
mesh size (to, say, $25$) like this:
\begin{displaymath}
 \texttt{set isosamples 25}
\end{displaymath}
Putting all this together, we get the following graph with these commands:\vspace{2mm}

\begin{tabular}{l @{}}
\texttt{set zeroaxis}\\
\texttt{set view 60,120,1,1}\\
\texttt{set xlabel "x"}\\
\texttt{set ylabel "y"}\\
\texttt{set zlabel "z"}\\
\texttt{set contour both}\\
\texttt{set isosamples 25}\\
\texttt{splot \symbol{91}-1:1\symbol{93}\symbol{91}-2:2\symbol{93} 2*(x**2) + y**2, exp(x+y)}
\end{tabular}
\newpage
\begin{figure}[h]
 \begin{center}
  \input{appc2}
 \end{center}\vspace{-15mm}
\end{figure}

The numbers listed below the functions in the key in the upper right corner of the graph are the ``levels'' of the
level curves of the corresponding surface. That is, they are the numbers $c$ such that $f(x,y)=c$.
Because of the large number of level curves, the key was put outside the graph with the
\textbf{set key outside} command.
If you do not want the function key displayed, it can be turned off with this command: \textbf{unset key}\vspace{2mm}

\par\noindent\textbf{PARAMETRIC FUNCTIONS}\vspace{2mm}\\
Gnuplot has the ability to graph surfaces given in various parametric forms. For example, for a surface
parametrized in cylindrical coordinates
\begin{displaymath}
 x=r\cos \theta ~,\quad y=r\sin \theta ~,\quad z=z
\end{displaymath}
you would do the following:\vspace{2mm}

\begin{tabular}{l @{}}
\texttt{set mapping cylindrical}\\
\texttt{set parametric}\\
\texttt{splot \symbol{91}a:b\symbol{93}\symbol{91}c:d\symbol{93} v*cos(u),v*sin(u),f(u,v)}
\end{tabular}\vspace{2mm}

\par\noindent where the variable $u$ represents $\theta$, with $a\le u \le b$, the variable $v$ represents $r$, with
$c\le v\le d$, and $z=f(u,v)$ is some function of $u$ and $v$.

\vspace{3mm}
\hrule width \textwidth height 0.5pt\vspace{2mm}
\par\noindent \emph{\textbf{Example C.2.}} The graph of the helicoid
$z=\theta$ in Example \ref{exmp:helicoid} from Section 1.7 (p. \pageref{exmp:helicoid}) was created using
the following commands:\vspace{2mm}

\begin{tabular}{l @{}}
\texttt{set mapping cylindrical}\\
\texttt{set parametric}\\
\texttt{set view 60,120,1,1}\\
\texttt{set xyplane 0}\\
\texttt{set xlabel "x"}\\
\texttt{set ylabel "y"}\\
\texttt{set zlabel "z"}\\
\texttt{unset key}\\
\texttt{set isosamples 15}\\
\texttt{splot \symbol{91}0:4*pi\symbol{93}\symbol{91}0:2\symbol{93} v*cos(u),v*sin(u),u}
\end{tabular}\vspace{2mm}

\par\noindent The command \textbf{set xyplane 0} moves the $z$-axis so that $z=0$ aligns with the $xy$-plane (which
is \emph{not} the default in Gnuplot). Looking at the graph, you will see that $r$ varies from $0$ to $2$, and $\theta$
varies from $0$ to $4\pi$.\vspace{2mm}
\hrule width \textwidth height 0.5pt\vspace{1mm}
\vspace{3mm}

\par\noindent\textbf{PRINTING AND SAVING}\vspace{2mm}\\
In Windows, to print a graph from Gnuplot right-click on the titlebar of the graph's window, select ``Options'' and then
the ``Print..'' option. If that does not work on your version of Gnuplot, then go to the File menu on the main Gnuplot menubar,
select ``Output Device ...'', and enter \path{pdf} in the \emph{Terminal type?} textfield, hit OK. That will
allow you to print the graph as a PDF file.

To save a graph, say, as a PNG file, go to the File menu on the main Gnuplot menubar,
select ``Output Device ...'', and enter \path{png} in the \emph{Terminal type?} textfield, hit OK. Then, in the
File menu again, select the ``Output ...'' option and enter a filename (say, graph.png) in the \emph{Output
filename?} textfield, hit OK. Now run your splot command again and you should see a file called
graph.png in the current directory (usually the directory where \path{wgnuplot.exe} is located, though you can change
that setting using the ``Change Directory ...'' option in the File menu).\\

\par\noindent In Linux, to save the graph as a file called graph.png, you would issue the following
commands:\vspace{2mm}

\begin{tabular}{l @{}}
\texttt{set terminal png}\\
\texttt{set output 'graph.png'}
\end{tabular}\vspace{2mm}

\par\noindent and then run your splot command. There are many terminal types (which determine the output format). Run
the command \textbf{set terminal} to see all the possible types. In Linux, the \textbf{postscript} terminal type is
popular, since the print quality is high and there are many PostScript viewers available.
\vspace{2mm}

\par\noindent To quit Gnuplot, type \textbf{quit} at the \textbf{\path{gnuplot>}} command prompt.
